<!-- Path: core/templates/core/partials/article_list_partial.html -->

{% load markdown_deux_tags %}

{% for post in page_obj %}
  <div class="space-y-12 py-6">
    <div class="group">
      <h2 class="text-2xl font-bold text-gray-100 group-hover:text-cyan-400 transition-colors duration-300">
        <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
      </h2>
      <div class="text-sm text-gray-400 mt-2 mb-4">
        <span>Опубликовано: {{ post.published_date|date:"d E Y" }}</span>
        {% if post.category %}
          <span>| Категория: <a href="{{ post.category.get_absolute_url }}" class="hover:text-cyan-400">{{ post.category.name }}</a></span>
        {% endif %}
      </div>
      <p class="text-gray-300 text-lg">
        {{ post.content|markdown|striptags|truncatewords:30 }}
      </p>
      <div class="mt-4">
        <a href="{{ post.get_absolute_url }}" class="text-cyan-400 font-semibold hover:text-cyan-300">Читать далее →</a>
      </div>
    </div>
  </div>
{% endfor %}

{% if page_obj.has_next %}
  <div id="load-more-trigger" class="flex justify-center mt-8">
      <button 
          hx-get="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"
          hx-trigger="click"
          hx-target="#load-more-trigger"
          hx-swap="outerHTML"
          class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-6 rounded-lg transition-colors duration-300">
          Загрузить еще
      </button>
  </div>
{% endif %}